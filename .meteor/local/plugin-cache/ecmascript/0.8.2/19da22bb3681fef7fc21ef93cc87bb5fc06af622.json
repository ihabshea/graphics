{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","classCallCheck","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"jquery","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"$"}]},{"source":"./foundation.util.core","imported":["GetYoDigits"],"specifiers":[{"kind":"named","imported":"GetYoDigits","local":"GetYoDigits"}]},{"source":"./foundation.plugin","imported":["Plugin"],"specifiers":[{"kind":"named","imported":"Plugin","local":"Plugin"}]},{"source":"./foundation.smoothScroll","imported":["SmoothScroll"],"specifiers":[{"kind":"named","imported":"SmoothScroll","local":"SmoothScroll"}]}],"exports":{"exported":["Magellan"],"specifiers":[{"kind":"local","local":"Magellan","exported":"Magellan"}]}}},"options":{"filename":"packages/zurb:foundation-sites/js/foundation.magellan.js","filenameRelative":"packages/zurb:foundation-sites/js/foundation.magellan.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/zurb:foundation-sites/js/foundation.magellan.js.map","sourceFileName":"packages/zurb:foundation-sites/js/foundation.magellan.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"foundation.magellan"},"ignored":false,"code":"'use strict';\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar module1 = module;\nmodule1.export({\n  Magellan: function () {\n    return Magellan;\n  }\n});\nvar $ = void 0;\nmodule1.watch(require(\"jquery\"), {\n  \"default\": function (v) {\n    $ = v;\n  }\n}, 0);\nvar GetYoDigits = void 0;\nmodule1.watch(require(\"./foundation.util.core\"), {\n  GetYoDigits: function (v) {\n    GetYoDigits = v;\n  }\n}, 1);\nvar Plugin = void 0;\nmodule1.watch(require(\"./foundation.plugin\"), {\n  Plugin: function (v) {\n    Plugin = v;\n  }\n}, 2);\nvar SmoothScroll = void 0;\nmodule1.watch(require(\"./foundation.smoothScroll\"), {\n  SmoothScroll: function (v) {\n    SmoothScroll = v;\n  }\n}, 3);\n\n/**\n * Magellan module.\n * @module foundation.magellan\n * @requires foundation.smoothScroll\n */var Magellan = function (_Plugin) {\n  (0, _inherits3.default)(Magellan, _Plugin);\n\n  function Magellan() {\n    (0, _classCallCheck3.default)(this, Magellan);\n    return (0, _possibleConstructorReturn3.default)(this, _Plugin.apply(this, arguments));\n  }\n\n  /**\n   * Creates a new instance of Magellan.\n   * @class\n   * @name Magellan\n   * @fires Magellan#init\n   * @param {Object} element - jQuery object to add the trigger to.\n   * @param {Object} options - Overrides to the default plugin settings.\n   */Magellan.prototype._setup = function () {\n    function _setup(element, options) {\n      this.$element = element;\n      this.options = $.extend({}, Magellan.defaults, this.$element.data(), options);\n      this.className = 'Magellan'; // ie9 back compat\n\n      this._init();\n\n      this.calcPoints();\n    }\n\n    return _setup;\n  }(); /**\n        * Initializes the Magellan plugin and calls functions to get equalizer functioning on load.\n        * @private\n        */\n\n  Magellan.prototype._init = function () {\n    function _init() {\n      var id = this.$element[0].id || GetYoDigits(6, 'magellan');\n\n      var _this = this;\n\n      this.$targets = $('[data-magellan-target]');\n      this.$links = this.$element.find('a');\n      this.$element.attr({\n        'data-resize': id,\n        'data-scroll': id,\n        'id': id\n      });\n      this.$active = $();\n      this.scrollPos = parseInt(window.pageYOffset, 10);\n\n      this._events();\n    }\n\n    return _init;\n  }(); /**\n        * Calculates an array of pixel values that are the demarcation lines between locations on the page.\n        * Can be invoked if new elements are added or the size of a location changes.\n        * @function\n        */\n\n  Magellan.prototype.calcPoints = function () {\n    function calcPoints() {\n      var _this = this,\n          body = document.body,\n          html = document.documentElement;\n\n      this.points = [];\n      this.winHeight = Math.round(Math.max(window.innerHeight, html.clientHeight));\n      this.docHeight = Math.round(Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight));\n      this.$targets.each(function () {\n        var $tar = $(this),\n            pt = Math.round($tar.offset().top - _this.options.threshold);\n        $tar.targetPoint = pt;\n\n        _this.points.push(pt);\n      });\n    }\n\n    return calcPoints;\n  }(); /**\n        * Initializes events for Magellan.\n        * @private\n        */\n\n  Magellan.prototype._events = function () {\n    function _events() {\n      var _this = this,\n          $body = $('html, body'),\n          opts = {\n        duration: _this.options.animationDuration,\n        easing: _this.options.animationEasing\n      };\n\n      $(window).one('load', function () {\n        if (_this.options.deepLinking) {\n          if (location.hash) {\n            _this.scrollToLoc(location.hash);\n          }\n        }\n\n        _this.calcPoints();\n\n        _this._updateActive();\n      });\n      this.$element.on({\n        'resizeme.zf.trigger': this.reflow.bind(this),\n        'scrollme.zf.trigger': this._updateActive.bind(this)\n      }).on('click.zf.magellan', 'a[href^=\"#\"]', function (e) {\n        e.preventDefault();\n        var arrival = this.getAttribute('href');\n\n        _this.scrollToLoc(arrival);\n      });\n\n      this._deepLinkScroll = function (e) {\n        if (_this.options.deepLinking) {\n          _this.scrollToLoc(window.location.hash);\n        }\n      };\n\n      $(window).on('popstate', this._deepLinkScroll);\n    }\n\n    return _events;\n  }(); /**\n        * Function to scroll to a given location on the page.\n        * @param {String} loc - a properly formatted jQuery id selector. Example: '#foo'\n        * @function\n        */\n\n  Magellan.prototype.scrollToLoc = function () {\n    function scrollToLoc(loc) {\n      this._inTransition = true;\n\n      var _this = this;\n\n      var options = {\n        animationEasing: this.options.animationEasing,\n        animationDuration: this.options.animationDuration,\n        threshold: this.options.threshold,\n        offset: this.options.offset\n      };\n      SmoothScroll.scrollToLoc(loc, options, function () {\n        _this._inTransition = false;\n\n        _this._updateActive();\n      });\n    }\n\n    return scrollToLoc;\n  }(); /**\n        * Calls necessary functions to update Magellan upon DOM change\n        * @function\n        */\n\n  Magellan.prototype.reflow = function () {\n    function reflow() {\n      this.calcPoints();\n\n      this._updateActive();\n    }\n\n    return reflow;\n  }(); /**\n        * Updates the visibility of an active location link, and updates the url hash for the page, if deepLinking enabled.\n        * @private\n        * @function\n        * @fires Magellan#update\n        */\n\n  Magellan.prototype._updateActive = function () {\n    function _updateActive() /*evt, elem, scrollPos*/{\n      if (this._inTransition) {\n        return;\n      }\n\n      var winPos = /*scrollPos ||*/parseInt(window.pageYOffset, 10),\n          curIdx;\n\n      if (winPos + this.winHeight === this.docHeight) {\n        curIdx = this.points.length - 1;\n      } else if (winPos < this.points[0]) {\n        curIdx = undefined;\n      } else {\n        var isDown = this.scrollPos < winPos,\n            _this = this,\n            curVisible = this.points.filter(function (p, i) {\n          return isDown ? p - _this.options.offset <= winPos : p - _this.options.offset - _this.options.threshold <= winPos;\n        });\n\n        curIdx = curVisible.length ? curVisible.length - 1 : 0;\n      }\n\n      this.$active.removeClass(this.options.activeClass);\n      this.$active = this.$links.filter('[href=\"#' + this.$targets.eq(curIdx).data('magellan-target') + '\"]').addClass(this.options.activeClass);\n\n      if (this.options.deepLinking) {\n        var hash = \"\";\n\n        if (curIdx != undefined) {\n          hash = this.$active[0].getAttribute('href');\n        }\n\n        if (hash !== window.location.hash) {\n          if (window.history.pushState) {\n            window.history.pushState(null, null, hash);\n          } else {\n            window.location.hash = hash;\n          }\n        }\n      }\n\n      this.scrollPos = winPos; /**\n                                * Fires when magellan is finished updating to the new active element.\n                                * @event Magellan#update\n                                */\n      this.$element.trigger('update.zf.magellan', [this.$active]);\n    }\n\n    return _updateActive;\n  }(); /**\n        * Destroys an instance of Magellan and resets the url of the window.\n        * @function\n        */\n\n  Magellan.prototype._destroy = function () {\n    function _destroy() {\n      this.$element.off('.zf.trigger .zf.magellan').find(\".\" + this.options.activeClass).removeClass(this.options.activeClass);\n\n      if (this.options.deepLinking) {\n        var hash = this.$active[0].getAttribute('href');\n        window.location.hash.replace(hash, '');\n      }\n\n      $(window).off('popstate', this._deepLinkScroll);\n    }\n\n    return _destroy;\n  }();\n\n  return Magellan;\n}(Plugin); /**\n            * Default settings for plugin\n            */\n\nMagellan.defaults = {\n  /**\n   * Amount of time, in ms, the animated scrolling should take between locations.\n   * @option\n   * @type {number}\n   * @default 500\n   */animationDuration: 500,\n  /**\n   * Animation style to use when scrolling between locations. Can be `'swing'` or `'linear'`.\n   * @option\n   * @type {string}\n   * @default 'linear'\n   * @see {@link https://api.jquery.com/animate|Jquery animate}\n   */animationEasing: 'linear',\n  /**\n   * Number of pixels to use as a marker for location changes.\n   * @option\n   * @type {number}\n   * @default 50\n   */threshold: 50,\n  /**\n   * Class applied to the active locations link on the magellan container.\n   * @option\n   * @type {string}\n   * @default 'is-active'\n   */activeClass: 'is-active',\n  /**\n   * Allows the script to manipulate the url of the current page, and if supported, alter the history.\n   * @option\n   * @type {boolean}\n   * @default false\n   */deepLinking: false,\n  /**\n   * Number of pixels to offset the scroll of the page on item click if using a sticky nav bar.\n   * @option\n   * @type {number}\n   * @default 0\n   */offset: 0\n};","map":{"version":3,"sources":["packages/zurb:foundation-sites/js/foundation.magellan.js"],"names":["module1","module","export","Magellan","$","watch","require","v","GetYoDigits","Plugin","SmoothScroll","_setup","element","options","$element","extend","defaults","data","className","_init","calcPoints","id","_this","$targets","$links","find","attr","$active","scrollPos","parseInt","window","pageYOffset","_events","body","document","html","documentElement","points","winHeight","Math","round","max","innerHeight","clientHeight","docHeight","scrollHeight","offsetHeight","each","$tar","pt","offset","top","threshold","targetPoint","push","$body","opts","duration","animationDuration","easing","animationEasing","one","deepLinking","location","hash","scrollToLoc","_updateActive","on","reflow","bind","e","preventDefault","arrival","getAttribute","_deepLinkScroll","loc","_inTransition","winPos","curIdx","length","undefined","isDown","curVisible","filter","p","i","removeClass","activeClass","eq","addClass","history","pushState","trigger","_destroy","off","replace"],"mappings":"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","file":"packages/zurb:foundation-sites/js/foundation.magellan.js.map","sourcesContent":["'use strict';\n\n\nimport $ from 'jquery';\nimport { GetYoDigits } from './foundation.util.core';\nimport { Plugin } from './foundation.plugin';\nimport { SmoothScroll } from './foundation.smoothScroll';\n\n/**\n * Magellan module.\n * @module foundation.magellan\n * @requires foundation.smoothScroll\n */\n\nclass Magellan extends Plugin {\n  /**\n   * Creates a new instance of Magellan.\n   * @class\n   * @name Magellan\n   * @fires Magellan#init\n   * @param {Object} element - jQuery object to add the trigger to.\n   * @param {Object} options - Overrides to the default plugin settings.\n   */\n  _setup(element, options) {\n    this.$element = element;\n    this.options  = $.extend({}, Magellan.defaults, this.$element.data(), options);\n    this.className = 'Magellan'; // ie9 back compat\n\n    this._init();\n    this.calcPoints();\n  }\n\n  /**\n   * Initializes the Magellan plugin and calls functions to get equalizer functioning on load.\n   * @private\n   */\n  _init() {\n    var id = this.$element[0].id || GetYoDigits(6, 'magellan');\n    var _this = this;\n    this.$targets = $('[data-magellan-target]');\n    this.$links = this.$element.find('a');\n    this.$element.attr({\n      'data-resize': id,\n      'data-scroll': id,\n      'id': id\n    });\n    this.$active = $();\n    this.scrollPos = parseInt(window.pageYOffset, 10);\n\n    this._events();\n  }\n\n  /**\n   * Calculates an array of pixel values that are the demarcation lines between locations on the page.\n   * Can be invoked if new elements are added or the size of a location changes.\n   * @function\n   */\n  calcPoints() {\n    var _this = this,\n        body = document.body,\n        html = document.documentElement;\n\n    this.points = [];\n    this.winHeight = Math.round(Math.max(window.innerHeight, html.clientHeight));\n    this.docHeight = Math.round(Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight));\n\n    this.$targets.each(function(){\n      var $tar = $(this),\n          pt = Math.round($tar.offset().top - _this.options.threshold);\n      $tar.targetPoint = pt;\n      _this.points.push(pt);\n    });\n  }\n\n  /**\n   * Initializes events for Magellan.\n   * @private\n   */\n  _events() {\n    var _this = this,\n        $body = $('html, body'),\n        opts = {\n          duration: _this.options.animationDuration,\n          easing:   _this.options.animationEasing\n        };\n    $(window).one('load', function(){\n      if(_this.options.deepLinking){\n        if(location.hash){\n          _this.scrollToLoc(location.hash);\n        }\n      }\n      _this.calcPoints();\n      _this._updateActive();\n    });\n\n    this.$element.on({\n      'resizeme.zf.trigger': this.reflow.bind(this),\n      'scrollme.zf.trigger': this._updateActive.bind(this)\n    }).on('click.zf.magellan', 'a[href^=\"#\"]', function(e) {\n        e.preventDefault();\n        var arrival   = this.getAttribute('href');\n        _this.scrollToLoc(arrival);\n      });\n\n    this._deepLinkScroll = function(e) {\n      if(_this.options.deepLinking) {\n        _this.scrollToLoc(window.location.hash);\n      }\n    };\n\n    $(window).on('popstate', this._deepLinkScroll);\n  }\n\n  /**\n   * Function to scroll to a given location on the page.\n   * @param {String} loc - a properly formatted jQuery id selector. Example: '#foo'\n   * @function\n   */\n  scrollToLoc(loc) {\n    this._inTransition = true;\n    var _this = this;\n\n    var options = {\n      animationEasing: this.options.animationEasing,\n      animationDuration: this.options.animationDuration,\n      threshold: this.options.threshold,\n      offset: this.options.offset\n    };\n\n    SmoothScroll.scrollToLoc(loc, options, function() {\n      _this._inTransition = false;\n      _this._updateActive();\n    })\n  }\n\n  /**\n   * Calls necessary functions to update Magellan upon DOM change\n   * @function\n   */\n  reflow() {\n    this.calcPoints();\n    this._updateActive();\n  }\n\n  /**\n   * Updates the visibility of an active location link, and updates the url hash for the page, if deepLinking enabled.\n   * @private\n   * @function\n   * @fires Magellan#update\n   */\n  _updateActive(/*evt, elem, scrollPos*/) {\n    if(this._inTransition) {return;}\n    var winPos = /*scrollPos ||*/ parseInt(window.pageYOffset, 10),\n        curIdx;\n\n    if(winPos + this.winHeight === this.docHeight){ curIdx = this.points.length - 1; }\n    else if(winPos < this.points[0]){ curIdx = undefined; }\n    else{\n      var isDown = this.scrollPos < winPos,\n          _this = this,\n          curVisible = this.points.filter(function(p, i){\n            return isDown ? p - _this.options.offset <= winPos : p - _this.options.offset - _this.options.threshold <= winPos;\n          });\n      curIdx = curVisible.length ? curVisible.length - 1 : 0;\n    }\n\n    this.$active.removeClass(this.options.activeClass);\n    this.$active = this.$links.filter('[href=\"#' + this.$targets.eq(curIdx).data('magellan-target') + '\"]').addClass(this.options.activeClass);\n\n    if(this.options.deepLinking){\n      var hash = \"\";\n      if(curIdx != undefined){\n        hash = this.$active[0].getAttribute('href');\n      }\n      if(hash !== window.location.hash) {\n        if(window.history.pushState){\n          window.history.pushState(null, null, hash);\n        }else{\n          window.location.hash = hash;\n        }\n      }\n    }\n\n    this.scrollPos = winPos;\n    /**\n     * Fires when magellan is finished updating to the new active element.\n     * @event Magellan#update\n     */\n    this.$element.trigger('update.zf.magellan', [this.$active]);\n  }\n\n  /**\n   * Destroys an instance of Magellan and resets the url of the window.\n   * @function\n   */\n  _destroy() {\n    this.$element.off('.zf.trigger .zf.magellan')\n        .find(`.${this.options.activeClass}`).removeClass(this.options.activeClass);\n\n    if(this.options.deepLinking){\n      var hash = this.$active[0].getAttribute('href');\n      window.location.hash.replace(hash, '');\n    }\n    $(window).off('popstate', this._deepLinkScroll);\n  }\n}\n\n/**\n * Default settings for plugin\n */\nMagellan.defaults = {\n  /**\n   * Amount of time, in ms, the animated scrolling should take between locations.\n   * @option\n   * @type {number}\n   * @default 500\n   */\n  animationDuration: 500,\n  /**\n   * Animation style to use when scrolling between locations. Can be `'swing'` or `'linear'`.\n   * @option\n   * @type {string}\n   * @default 'linear'\n   * @see {@link https://api.jquery.com/animate|Jquery animate}\n   */\n  animationEasing: 'linear',\n  /**\n   * Number of pixels to use as a marker for location changes.\n   * @option\n   * @type {number}\n   * @default 50\n   */\n  threshold: 50,\n  /**\n   * Class applied to the active locations link on the magellan container.\n   * @option\n   * @type {string}\n   * @default 'is-active'\n   */\n  activeClass: 'is-active',\n  /**\n   * Allows the script to manipulate the url of the current page, and if supported, alter the history.\n   * @option\n   * @type {boolean}\n   * @default false\n   */\n  deepLinking: false,\n  /**\n   * Number of pixels to offset the scroll of the page on item click if using a sticky nav bar.\n   * @option\n   * @type {number}\n   * @default 0\n   */\n  offset: 0\n}\n\nexport {Magellan};\n"]},"hash":"19da22bb3681fef7fc21ef93cc87bb5fc06af622"}
